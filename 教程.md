📚 HSP 语言完全教程

从零开始学会概率编程

---

第一课：你好，HSP！

1.1 第一个程序

创建一个文件 hello.hps：

```hsp
¢ 这是我的第一个 HSP 程序
¢,你好，HSP！
```

运行：

```bash
python hsp.py hello.hps
```

输出：

```
[时间] 你好，HSP！
```

讲解：

· ¢ 是注释符号，后面的文字不会执行
· ¢, 是输出指令，会在屏幕上显示文字

---

1.2 输出变量

```hsp
#名字 = "雷电将军"
¢,我的名字是：#名字
```

输出：

```
[时间] 我的名字是：雷电将军
```

#名字 会被替换成变量的值。

---

第二课：变量和数学

2.1 变量赋值

```hsp
#抽数 = 100                 # 整数
#概率 = 0.6                  # 小数
#名字 = "胡桃"               # 字符串
¢,抽了 #抽数 次，概率 #概率%
```

2.2 数学运算

用 &A() 进行数学计算：

```hsp
#a = &A(1 + 2 × 3)      # 1+2×3 = 7
#b = &A(10 ÷ 2)         # 10÷2 = 5
#c = &A(2^10)           # 2的10次方 = 1024

¢,a = #a, b = #b, c = #c
```

支持的运算：

符号 含义 例子
+ 加法 1+2
- 减法 5-3
× 乘法 2×3
÷ 除法 10÷2
^ 乘方 2^10
() 括号 (1+2)×3

2.3 数学函数

```hsp
&A(㏒(100))      # 以10为底的对数 = 2
&A(㏑(2.718))    # 自然对数 ≈ 1
&A(√(9))         # 平方根 = 3
&A(π)            # 圆周率 ≈ 3.14159
&A(e)            # 自然常数 ≈ 2.71828
```

---

第三课：概率表达

3.1 普通概率

```hsp
0.6/      # 0.6%
1/        # 1%
50/       # 50%
100/      # 100%
```

3.2 科学计数法（处理极小概率）

```hsp
1/-3      # 1×10⁻³ = 0.001
1.7/-97   # 1.7×10⁻⁹⁷ (你最初的问题)
1/+80     # 1×10⁸⁰ (宇宙原子总数)
```

练习：对比宇宙尺度

```hsp
#极小 = 1.7/-97
#宇宙 = 1/+80
#比例 = &A(#极小 ÷ #宇宙)
¢,比例：#比例
```

---

第四课：抽卡池

4.1 定义池子

格式：(概率/:物品1,物品2,物品3)#池子名

```hsp
(0.6/:$雷电,$甘雨,$胡桃)#角色UP
(1/:$和璞鸢,$贯虹,$护摩)#武器池
(0.1/:$1,$2,$3,$4,$5)#常驻池
```

讲解：

· 0.6/ 是总概率 0.6%
· $雷电 是物品（$符号表示物品）
· #角色UP 是池子名字

4.2 查看定义的池子

```hsp
#stats
```

会显示当前有多少个池子。

---

第五课：目标声明（核心功能）

5.1 基本格式

```hsp
<$物品, #池子 ×:抽法, *保底数>
```

例子：

```hsp
<$雷电, #角色UP ×:10, *90>
```

含义：想要雷电将军，在角色UP池里十连抽，90抽内必得。

5.2 不同抽法

```hsp
<$雷电, #角色UP ×:10, *90>    # 10连
<$甘雨, #角色UP ×:1, *180>     # 单抽
<$和璞鸢, #武器池 ×:10, *80>   # 10连武器池
```

5.3 完整例子

```hsp
(0.6/:$雷电,$甘雨)#角色UP

¢,开始抽雷神...
<$雷电,#角色UP×:10,*90>

¢,抽卡完成！
```

运行后会看到模拟抽卡的过程。

---

第六课：条件判断

6.1 基本条件

```hsp
?(条件) ⇒ 执行的动作
```

例子：

```hsp
#抽数 = 90
?(#抽数 > 80) ⇒ ¢,快保底了！
```

6.2 物品状态判断

```hsp
?($雷电=) ⇒ ¢,抽到了！      # 如果抽到雷电
?($雷电≠) ⇒ ¢,继续努力       # 如果没抽到
```

6.3 完整例子

```hsp
(0.6/:$雷电)#角色UP

#成功 = 0
for #i = 1 to 10 {
  <$雷电,#角色UP×:10,*90>
  ?($雷电=) ⇒ #成功 = #成功 + 1
}

¢,10次中成功了 #成功 次
```

---

第七课：循环

7.1 for 循环

```hsp
for #i = 1 to 10 {
  ¢,第 #i 次循环
}
```

抽卡例子：

```hsp
(0.6/:$雷电)#角色UP

#总抽数 = 0
for #i = 1 to 5 {
  <$雷电,#角色UP×:10,*90>
  #总抽数 = #总抽数 + 90
}
¢,总抽数：#总抽数
```

7.2 while 循环

```hsp
#抽数 = 0
while #抽数 < 90 {
  #抽数 = #抽数 + 10
  ¢,已抽 #抽数 抽
}
```

---

第八课：批量实验

8.1 循环记录 #¢{}±

格式：#¢{要重复的操作}± (次数)

```hsp
#¢{<$雷电,#角色UP×:10,*90>}± (100)
```

执行100次抽卡，自动统计成功率。

8.2 查看实验结果

```hsp
#¢{抽卡}± (1000)
#成功率 = #¢.rate
¢,1000次实验，成功率：#成功率%
#stats
```

8.3 对比不同策略

```hsp
(0.6/:$雷电)#角色UP

¢,策略1：10连
#¢{<$雷电,#角色UP×:10,*90>}± (100)
#率1 = #¢.rate

¢,策略2：单抽
#¢{<$雷电,#角色UP×:1,*90>}± (100)
#率2 = #¢.rate

¢,10连成功率：#率1%
¢,单抽成功率：#率2%
?(&A(#率1 > #率2)) ⇒ ¢,10连更好！，否则 ¢,单抽更好！
```

---

第九课：统计命令 #stats

9.1 查看统计信息

```hsp
#stats
```

显示：

· 运行时间
· 总抽卡次数
· 成功率
· 变量数量
· 池子数量

9.2 清空变量

```hsp
#clear        # 清空所有变量
#stats        # 查看清空后的状态
```

9.3 实战例子

```hsp
(0.6/:$雷电)#角色UP

¢,开始实验...
#¢{<$雷电,#角色UP×:10,*90>}± (1000)

¢,实验结束，查看统计：
#stats
```

---

第十课：完整项目实战

10.1 原神抽卡模拟器

创建 genshin.hps：

```hsp
¢===============================
¢ 原神角色UP池抽卡模拟器
¢===============================

¢ 1. 定义池子
(0.6/:$雷电,$甘雨,$胡桃,$钟离)#角色UP

¢ 2. 设置目标
#目标 = $雷电
#目标名 = "雷电将军"

¢ 3. 初始化
#预算 = ¥40000
#单价 = 160
#总抽数 = 0
#成功 = 0

¢,【开始抽卡】目标：#目标名

¢ 4. 模拟10次抽卡
for #i = 1 to 10 {
  ¢,--- 第 #i 次抽卡 ---
  <$雷电,#角色UP×:10,*90>
  
  #总抽数 = #总抽数 + 90
  ?($雷电=) ⇒ #成功 = #成功 + 1
  
  #进度 = &A(#i × 10)%
  ¢,进度：#进度
}

¢ 5. 统计结果
#成功率 = &A(#成功 ÷ 10 × 100)
#花费 = &A(#总抽数 × #单价)

¢,【最终报告】
¢,目标：#目标名
¢,总抽数：#总抽数
¢,成功次数：#成功
¢,成功率：#成功率%
¢,总花费：¥#花费
¢,平均每抽：¥#单价

#stats
```

运行：

```bash
python hsp.py genshin.hps
```

10.2 验证大数定律

创建 lawoflarge.hps：

```hsp
¢===============================
¢ 大数定律验证
¢===============================

(0.6/:$五星)#池子

¢,【小样本实验】10次
#¢{<$五星,#池子×:100,*100>}± (10)
#率1 = #¢.rate
¢,10次实验成功率：#率1%

¢,【大样本实验】1000次
#¢{<$五星,#池子×:100,*100>}± (1000)
#率2 = #¢.rate
¢,1000次实验成功率：#率2%

¢,【理论值】
#理论 = 0.6%
¢,理论概率：#理论

#误差1 = &A(abs(#率1 - 0.6))
#误差2 = &A(abs(#率2 - 0.6))
¢,小样本误差：#误差1%
¢,大样本误差：#误差2%

?(&A(#误差2 < #误差1)) ⇒ ¢,✓ 大数定律成立！，否则 ¢,? 需要更多样本
```

10.3 最初的问题

创建 original.hps：

```hsp
¢===============================
¢ 最初的问题：1.7×10⁻⁹⁷
¢===============================

#极小 = 1.7/-97
¢,【数值】
¢,  科学计数法：1.7×10⁻⁹⁷
¢,  小数表示：{#极小}

#宇宙原子 = 1/+80
¢,【对比】
¢,  宇宙原子总数：10⁸⁰
¢,  比例：&A(#极小 ÷ #宇宙原子)
¢,  需要 &A(1 ÷ #极小) 次试验才期望发生一次

#对数 = &A(㏒(#极小))
¢,【信息论】
¢,  信息量：{#对数:.2f} 比特

¢,【HSP 表达】
¢,  这就是 HSP 诞生的原因
```

---

第十一课：调试技巧

11.1 常用调试命令

```hsp
#stats        # 查看当前状态
#clear        # 清空所有变量
¢,变量值：#变量名   # 输出变量值
```

11.2 分段调试

```hsp
#stats                    ← 开始前

(0.6/:$雷电)#角色UP
#stats                    ← 检查池子是否创建成功

<$雷电,#角色UP×:10,*90>
#stats                    ← 检查抽卡结果

#抽数 = 90
#stats                    ← 检查变量赋值
```

11.3 常见错误

```hsp
❌ 错误：忘记写 #
抽数 = 100
✅ 正确：#抽数 = 100

❌ 错误：概率少写 /
(0.6:$雷电)#角色UP
✅ 正确：(0.6/:$雷电)#角色UP

❌ 错误：目标格式不对
<$雷电,#角色UP,10,90>
✅ 正确：<$雷电,#角色UP×:10,*90>
```

---

第十二课：速查表

12.1 符号速查

符号 含义 例子
¢ 注释 ¢ 这是注释
¢, 输出 ¢,你好
# 变量 #抽数 = 100
$ 物品 $雷电
&A() 数学运算 &A(1+2)
×: 抽卡方式 ×:10 十连
* 保底 *90 90抽保底
? 条件 ?($1=) ⇒ 停
#¢{}± 循环记录 #¢{抽卡}± (100)
#stats 统计 #stats
#clear 清空 #clear

12.2 数学函数

函数 含义 例子
㏒() 以10为底对数 ㏒(100)=2
㏑() 自然对数 ㏑(e)=1
√() 平方根 √(9)=3
π 圆周率 π=3.14159
e 自然常数 e=2.71828

12.3 概率表达

格式 含义 例子
0.6/ 0.6% 0.6/
1.7/-97 1.7×10⁻⁹⁷ 1.7/-97
1/+80 10⁸⁰ 1/+80

---
